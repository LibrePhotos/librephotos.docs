"use strict";(self.webpackChunklibrephotos_docs=self.webpackChunklibrephotos_docs||[]).push([[9584],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>k});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=a.createContext({}),u=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(l.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=u(n),h=i,k=p["".concat(l,".").concat(h)]||p[h]||d[h]||r;return n?a.createElement(k,o(o({ref:t},c),{},{components:n})):a.createElement(k,o({ref:t},c))}));function k(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[p]="string"==typeof e?e:i,o[1]=s;for(var u=2;u<r;u++)o[u]=n[u];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},4785:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>u});var a=n(7462),i=(n(7294),n(3905));const r={id:"api-authentication",title:"API authentication",sidebar_label:"API authentication",description:"How to authenticate against the LibrePhotos API (JWT and Basic auth)"},o=void 0,s={unversionedId:"user-guide/api-authentication",id:"user-guide/api-authentication",title:"API authentication",description:"How to authenticate against the LibrePhotos API (JWT and Basic auth)",source:"@site/docs/user-guide/api-authentication.md",sourceDirName:"user-guide",slug:"/user-guide/api-authentication",permalink:"/docs/user-guide/api-authentication",draft:!1,editUrl:"https://github.com/LibrePhotos/librephotos.docs/tree/master/docs/user-guide/api-authentication.md",tags:[],version:"current",frontMatter:{id:"api-authentication",title:"API authentication",sidebar_label:"API authentication",description:"How to authenticate against the LibrePhotos API (JWT and Basic auth)"},sidebar:"userguide",previous:{title:"\u2753 FAQ",permalink:"/docs/user-guide/faq"},next:{title:"Development",permalink:"/docs/development/"}},l={},u=[{value:"Authentication methods",id:"authentication-methods",level:3},{value:"Obtain a JWT access token",id:"obtain-a-jwt-access-token",level:3},{value:"Call APIs using the JWT access token",id:"call-apis-using-the-jwt-access-token",level:3},{value:"Call APIs using Basic auth (optional)",id:"call-apis-using-basic-auth-optional",level:3},{value:"Helpful endpoints",id:"helpful-endpoints",level:3},{value:"Troubleshooting 401/403",id:"troubleshooting-401403",level:3}],c={toc:u},p="wrapper";function d(e){let{components:t,...n}=e;return(0,i.kt)(p,(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"LibrePhotos secures most API endpoints and requires authentication by default. If you see 401 Unauthorized or 403 Forbidden responses when calling API endpoints, you likely need to authenticate using one of the supported methods below."),(0,i.kt)("h3",{id:"authentication-methods"},"Authentication methods"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"JWT (recommended): Obtain a short-lived access token via ",(0,i.kt)("inlineCode",{parentName:"li"},"/api/auth/token/obtain/")," and present it as a Bearer token. The obtain and refresh endpoints also set a ",(0,i.kt)("inlineCode",{parentName:"li"},"jwt")," cookie that the browser can reuse."),(0,i.kt)("li",{parentName:"ul"},"Basic authentication: For simple scripts or local testing, you can use HTTP Basic auth. Do not use Basic auth across untrusted networks.")),(0,i.kt)("p",null,"Session authentication is not enabled for API endpoints. The frontend uses JWT behind the scenes, not Django sessions."),(0,i.kt)("h3",{id:"obtain-a-jwt-access-token"},"Obtain a JWT access token"),(0,i.kt)("p",null,"Request an access token using your LibrePhotos username and password:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'curl -X POST "http://<backend>/api/auth/token/obtain/" \\\n  -H \'Content-Type: application/json\' \\\n  -d \'{"username":"myuser","password":"mypassword"}\'\n')),(0,i.kt)("p",null,"You will receive a JSON response with ",(0,i.kt)("inlineCode",{parentName:"p"},"access")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"refresh")," tokens. The response also sets a ",(0,i.kt)("inlineCode",{parentName:"p"},"jwt")," cookie with the access token for browser use."),(0,i.kt)("p",null,"Example response:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "refresh": "<refresh_token>",\n  "access": "<access_token>"\n}\n')),(0,i.kt)("p",null,"Refresh the access token when it expires using:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'curl -X POST "http://<backend>/api/auth/token/refresh/" \\\n  -H \'Content-Type: application/json\' \\\n  -d \'{"refresh":"<refresh_token>"}\'\n')),(0,i.kt)("h3",{id:"call-apis-using-the-jwt-access-token"},"Call APIs using the JWT access token"),(0,i.kt)("p",null,"Include the token in the ",(0,i.kt)("inlineCode",{parentName:"p"},"Authorization")," header:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"curl -H 'Authorization: Bearer <access_token>' \\\n  \"http://<backend>/api/photos/\"\n")),(0,i.kt)("p",null,"If you are in a browser environment and already called the token endpoints, the ",(0,i.kt)("inlineCode",{parentName:"p"},"jwt")," cookie will be set and used automatically by the backend for relevant media endpoints. For pure API calls, prefer the Authorization header."),(0,i.kt)("h3",{id:"call-apis-using-basic-auth-optional"},"Call APIs using Basic auth (optional)"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'curl -u myuser:mypassword "http://<backend>/api/photos/"\n')),(0,i.kt)("h3",{id:"helpful-endpoints"},"Helpful endpoints"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"API help: ",(0,i.kt)("inlineCode",{parentName:"li"},"http://<backend>/api/help")," returns a structured JSON with authentication instructions and example ",(0,i.kt)("inlineCode",{parentName:"li"},"curl")," commands."),(0,i.kt)("li",{parentName:"ul"},"OpenAPI/Swagger (development builds with DEBUG enabled):",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Schema: ",(0,i.kt)("inlineCode",{parentName:"li"},"http://<backend>/api/schema")),(0,i.kt)("li",{parentName:"ul"},"Swagger UI: ",(0,i.kt)("inlineCode",{parentName:"li"},"http://<backend>/api/swagger")),(0,i.kt)("li",{parentName:"ul"},"Redoc: ",(0,i.kt)("inlineCode",{parentName:"li"},"http://<backend>/api/redoc"))))),(0,i.kt)("h3",{id:"troubleshooting-401403"},"Troubleshooting 401/403"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Ensure you are including ",(0,i.kt)("inlineCode",{parentName:"li"},"Authorization: Bearer <access_token>")," or using Basic auth."),(0,i.kt)("li",{parentName:"ul"},"Verify the access token is current; refresh if needed."),(0,i.kt)("li",{parentName:"ul"},"If testing cross-origin from a separate frontend, ensure CORS and credentials are configured properly and that cookies are allowed if relying on the ",(0,i.kt)("inlineCode",{parentName:"li"},"jwt")," cookie.")))}d.isMDXComponent=!0}}]);